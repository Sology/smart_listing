import{Controller as e}from"@hotwired/stimulus";import t from"lodash/debounce";class r{static register(e,t){this.registryList[e]=t}static get(e){return this.registryList[e]}}r.registryList={};const s={reloadList:(e,t)=>{if(e&&t)return e.innerHTML=t.innerHTML;throw new Error(`Target: ${e}, template: ${t}`)},remove:e=>{if(e)return e.remove();throw new Error(`Target: ${e}`)}};class n extends e{connect(){r.register(this.nameValue,this)}beforeSend(e){switch(console.log("before",e),e.type){case"ajax:beforeSend":e.detail[0].setRequestHeader("Accept","text/vnd.smart-listing-remote.html");break;case"turbo:before-fetch-request":Turbo.navigator.history.push(new URL(e.detail.url))}return(e=>{const t=new Event("beforesend");e.dispatchEvent(t)})(this.element),!0}performAction(e,t,r){switch(e){case"replace":return s.reloadList(t,r);case"remove":return s.remove(t);default:throw new Error(`Unknown action: ${e}`)}}update(e){if(console.log("update",e),"ajax:complete"==e.type){const[t,r]=e.detail;"OK"===r?(new DOMParser).parseFromString(t.response,"text/html").querySelectorAll("smart-listing-action").forEach(e=>{const t=e.getAttribute("name"),r=e.getAttribute("target"),s=document.getElementById(`${r}`),n=e.querySelector("template");this.performAction(t,s,n)}):console.error(`Status ${t.status}`)}(e=>{const t=new Event("aftercomplete");e.dispatchEvent(t)})(this.element)}}n.values={name:String};class o extends e{initialize(){this.refresh=t(this.refresh,500).bind(this)}connect(){}disconnect(){}refresh(e){console.log("refresh"),this.element.requestSubmit()}}o.targets=["observable"];const i={controllers:{main:{base:n,tailwind:class extends n{connect(){super.connect(),console.log("hello from tailwind controller"),this.element.addEventListener("beforesend",e=>{e.target.classList.add("opacity-25","pointer-events-none","transition-opacity")}),this.element.addEventListener("aftercomplete",e=>{e.target.classList.remove("opacity-25","pointer-events-none")})}}},controls:{base:o,tailwind:class extends o{}}},registry:r,actions:s};window.SmartListing=i;export default i;
//# sourceMappingURL=smart_listing.modern.js.map
